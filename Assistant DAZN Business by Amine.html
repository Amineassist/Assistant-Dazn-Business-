<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Assistant Prospection DAZN - CWC 2025</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f7fa;
      padding: 20px;
      color: #333;
    }
    h1, h2, h3 {
      color: #1a73e8;
    }
    textarea, input, button, select {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
    }
    .arguments {
      background: #e8f0fe;
      padding: 10px;
      margin-top: 10px;
      border-left: 5px solid #1a73e8;
    }
    .map-container {
      height: 300px;
      margin: 20px 0;
      border: 1px solid #ddd;
      position: relative;
    }
    #map {
      height: 100%;
    }
    .flex-container {
      display: flex;
      gap: 20px;
    }
    .flex-item {
      flex: 1;
    }
    @media (max-width: 768px) {
      .flex-container {
        flex-direction: column;
      }
    }
    #manual-details {
      margin-top: 15px;
    }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
</head>
<body>

<h1>ğŸ¯ Assistant en temps rÃ©el â€“ DAZN CWC 2025</h1>

<div class="flex-container">
  <div class="flex-item">
    <h2>ğŸ“ Identification de l'Ã©tablissement</h2>
    <input type="text" id="etablissement-search" placeholder="Nom de l'Ã©tablissement + ville">
    <button type="button" onclick="searchEstablishment()">ğŸ” Rechercher</button>
    
    <div class="map-container">
      <div id="map"></div>
    </div>
    
    <div id="manual-details">
      <h3>ğŸ“ ComplÃ©tez les dÃ©tails manuellement</h3>
      <label>Type d'Ã©tablissement</label>
      <select id="type" required>
        <option value="">SÃ©lectionnez...</option>
        <option value="bar">Bar</option>
        <option value="brasserie">Brasserie</option>
        <option value="cafÃ©">CafÃ©</option>
        <option value="restaurant">Restaurant</option>
        <option value="hÃ´tel">HÃ´tel</option>
        <option value="club">Club sportif</option>
      </select>
      
      <label>Adresse</label>
      <input type="text" id="adresse" placeholder="Adresse complÃ¨te">
      
      <label>Nombre d'Ã©crans</label>
      <input type="number" id="ecrans" min="1" max="10" required>
      
      <label>CapacitÃ© approximative</label>
      <input type="number" id="capacite" min="1" placeholder="Nombre de clients">
      
      <label>Fournisseurs actuels (Canal+, beIN...)</label>
      <input type="text" id="fournisseurs">
    </div>
  </div>

  <div class="flex-item">
    <h2>ğŸ¤ Pitch personnalisÃ©</h2>
    <button type="button" onclick="generatePitch()" style="background:#1a73e8;color:white;">GÃ©nÃ©rer le pitch de vente</button>
    <div class="arguments" id="pitch"></div>
    
    <h2>ğŸ“Š Analyse du potentiel</h2>
    <div id="potential-analysis" class="arguments"></div>
  </div>
</div>

<hr>
<h2>ğŸ™ï¸ Assistant vocal en direct â€“ Analyse des objections</h2>

<button onclick="startRecognition()" style="padding:10px 20px;background:#e91e63;color:white;">ğŸ¤ DÃ©marrer l'Ã©coute</button>
<p id="status">Micro inactif.</p>

<div>
  <h3>ğŸ—£ï¸ Ce que le client dit :</h3>
  <div id="transcription" style="border:1px solid #ccc; padding:10px; min-height:50px;"></div>

  <h3>ğŸ’¡ Suggestion pour rÃ©pondre :</h3>
  <div id="suggestion" class="arguments" style="background:#f7f7f7;"></div>
</div>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
// Carte Leaflet (OpenStreetMap)
let map;
let markers = [];

function initMap() {
  map = L.map('map').setView([48.8566, 2.3522], 13); // Paris par dÃ©faut
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);
  
  // Ajouter un marqueur au clic
  map.on('click', function(e) {
    clearMarkers();
    addMarker(e.latlng);
    document.getElementById("adresse").value = `Position: ${e.latlng.lat.toFixed(4)}, ${e.latlng.lng.toFixed(4)}`;
  });
}

function addMarker(latlng) {
  const marker = L.marker(latlng).addTo(map);
  markers.push(marker);
}

function clearMarkers() {
  markers.forEach(marker => map.removeLayer(marker));
  markers = [];
}

function searchEstablishment() {
  const query = document.getElementById("etablissement-search").value;
  if (!query) return;
  
  // Simulation de recherche (en rÃ©alitÃ© on utiliserait un service de gÃ©ocodage)
  document.getElementById("potential-analysis").innerHTML = `
    <p>ğŸ” <strong>${query}</strong> - Analyse basÃ©e sur les informations fournies:</p>
    <ul>
      <li>Type: <span id="display-type">Ã€ dÃ©finir</span></li>
      <li>CapacitÃ©: <span id="display-capacite">Ã€ dÃ©finir</span></li>
      <li>Ã‰crans: <span id="display-ecrans">Ã€ dÃ©finir</span></li>
    </ul>
    <p>ğŸ’¡ <strong>Conseil:</strong> ComplÃ©tez les dÃ©tails Ã  gauche pour une analyse prÃ©cise.</p>
  `;
  
  // Centrer sur une position alÃ©atoire proche (simulation)
  const lat = 48.8566 + (Math.random() * 0.02 - 0.01);
  const lng = 2.3522 + (Math.random() * 0.02 - 0.01);
  map.setView([lat, lng], 16);
  clearMarkers();
  addMarker([lat, lng]);
  
  // Mettre Ã  jour l'analyse quand les champs changent
  document.getElementById("type").addEventListener("change", updateAnalysis);
  document.getElementById("capacite").addEventListener("input", updateAnalysis);
  document.getElementById("ecrans").addEventListener("input", updateAnalysis);
}

function updateAnalysis() {
  const type = document.getElementById("type").value || "Ã€ dÃ©finir";
  const capacite = document.getElementById("capacite").value || "Ã€ dÃ©finir";
  const ecrans = document.getElementById("ecrans").value || "Ã€ dÃ©finir";
  
  document.getElementById("display-type").textContent = type;
  document.getElementById("display-capacite").textContent = capacite;
  document.getElementById("display-ecrans").textContent = ecrans;
  
  let conseil = "";
  if (type !== "Ã€ dÃ©finir" && capacite !== "Ã€ dÃ©finir" && ecrans !== "Ã€ dÃ©finir") {
    const score = (parseInt(capacite) * parseInt(ecrans)) / 10;
    
    if (score > 50) {
      conseil = "ğŸ”¥ Fort potentiel! Cet Ã©tablissement pourrait gÃ©nÃ©rer un trafic important pendant la CWC.";
    } else if (score > 20) {
      conseil = "ğŸ‘ Bon potentiel. Proposez des formules avec 1-2 Ã©crans pour commencer.";
    } else {
      conseil = "ğŸ’¡ Potentiel modÃ©rÃ©. Mettez en avant l'offre d'essai sans engagement.";
    }
    
    conseil += ` Score de potentiel: ${Math.round(score)}/100`;
  }
  
  if (conseil) {
    document.querySelector("#potential-analysis p:last-child").textContent = conseil;
  }
}

// Pitch generator amÃ©liorÃ©
function generatePitch() {
  const nom = document.getElementById("etablissement-search").value || "l'Ã©tablissement";
  const type = document.getElementById("type").value || "Ã©tablissement";
  const ecrans = parseInt(document.getElementById("ecrans").value) || 1;
  const capacite = parseInt(document.getElementById("capacite").value) || 30;
  const fournisseurs = document.getElementById("fournisseurs").value;
  const adresse = document.getElementById("adresse").value;

  let formule = "";
  if (ecrans <= 2) formule = "89â‚¬/mois";
  else if (ecrans <= 5) formule = "129â‚¬/mois";
  else formule = "199â‚¬/mois";

  const intro = `Bonjour, je vous appelle de la part de DAZN Business France dans le cadre du lancement de la Coupe du Monde des Clubs 2025. Nous diffusons en exclusivitÃ© l'intÃ©gralitÃ© des 63 matchs, dont PSG - Atletico et la finale.`;

  let personnalisÃ© = `Je vois que ${nom} est un ${type} ${adresse ? `situÃ© ${adresse}` : ''}. C'est une belle opportunitÃ© d'attirer les passionnÃ©s de sport cet Ã©tÃ©.`;
  
  // Adaptation en fonction de la capacitÃ©
  if (capacite > 100) {
    personnalisÃ© += ` Avec votre capacitÃ© d'accueil (${capacite} personnes), vous pourriez organiser des Ã©vÃ©nements autour des matchs importants.`;
  } else if (capacite > 50) {
    personnalisÃ© += ` Vos ${capacite} places assises seront idÃ©ales pour accueillir des groupes de supporters.`;
  }

  // Adaptation en fonction des fournisseurs actuels
  if (fournisseurs.includes("Canal+")) {
    personnalisÃ© += ` Je vois que vous Ãªtes dÃ©jÃ  client Canal+, DAZN est le complÃ©ment parfait pour offrir Ã  vos clients toute la Coupe du Monde des Clubs.`;
  } else if (fournisseurs.includes("beIN")) {
    personnalisÃ© += ` En complÃ©ment de beIN Sports, DAZN vous permettra de proposer une offre sportive complÃ¨te Ã  vos clients.`;
  }

  const offre = `Nous avons une formule Ã  ${formule}, adaptÃ©e Ã  vos ${ecrans} Ã©cran(s), avec engagement 12 mois, contenu illimitÃ© et matÃ©riel fourni.`;

  const action = `Souhaitez-vous qu'on planifie l'installation avant le lancement ? Vous bÃ©nÃ©ficiez de notre offre d'essai sans engagement jusqu'au 31 aoÃ»t.`;

  document.getElementById("pitch").innerHTML = `
    <p><strong>Introduction :</strong> ${intro}</p>
    <p><strong>Personnalisation :</strong> ${personnalisÃ©}</p>
    <p><strong>Offre :</strong> ${offre}</p>
    <p><strong>Appel Ã  l'action :</strong> ${action}</p>
  `;
}

// Assistant vocal
const keywords = {
  "TF1": "âœ… Seuls 2 matchs seront sur TF1 (PSG-Atletico & la finale). Les 61 autres sont exclusivement sur DAZN.",
  "trop cher": "ğŸ’° Nos tarifs sont environ 40% infÃ©rieurs Ã  Canal+ et RMC pour les pros, avec tous les matchs inclus.",
  "dÃ©jÃ  abonnÃ©": "ğŸ“¦ DAZN complÃ¨te parfaitement votre offre actuelle, surtout pour la CWC que les autres ne diffusent pas.",
  "j'attends la ligue 1": "âš½ DAZN diffuse aussi les 2 derniÃ¨res journÃ©es de Ligue 1 + barrages + compÃ©titions internationales.",
  "je veux rÃ©flÃ©chir": "ğŸ• L'offre sans engagement jusqu'au 31 aoÃ»t vous permet de tester sans risque.",
  "pas de clients": "ğŸ“ˆ Justement, la CWC attire du monde : 63 matchs en 4 semaines, parfait pour crÃ©er du trafic.",
  "c'est compliquÃ©": "ğŸ”§ On fournit le matÃ©riel, le service est clÃ© en main, activation rapide.",
  "pas d'Ã©cran": "ğŸ“º MÃªme un seul Ã©cran suffit ! Notre formule Essentielle Ã  89â‚¬/mois est parfaite pour dÃ©marrer."
};

let recognition;
function startRecognition() {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.lang = "fr-FR";
  recognition.continuous = true;
  recognition.interimResults = true;

  document.getElementById('status').innerText = "ğŸ§ Micro activÃ© â€“ En Ã©coute...";

  recognition.onresult = function(event) {
    let transcript = "";
    for (let i = event.resultIndex; i < event.results.length; ++i) {
      transcript += event.results[i][0].transcript;
    }
    document.getElementById("transcription").innerText = transcript;

    let lower = transcript.toLowerCase();
    for (let key in keywords) {
      if (lower.includes(key)) {
        document.getElementById("suggestion").innerText = keywords[key];
        return;
      }
    }
    document.getElementById("suggestion").innerText = "Aucune objection dÃ©tectÃ©e. Continuez l'Ã©change.";
  };

  recognition.onerror = function(event) {
    document.getElementById('status').innerText = "âŒ Erreur de reconnaissance vocale.";
  };

  recognition.onend = function() {
    document.getElementById('status').innerText = "ğŸ›‘ Micro arrÃªtÃ©.";
  };

  recognition.start();
}

// Initialisation
document.addEventListener('DOMContentLoaded', function() {
  initMap();
});
</script>

</body>
</html>